# KUTTL + CDK8s Notes

## Goal
Use KUTTL to assert on resources generated by CDK8s.

## Key Fixes

- ✅ **Set explicit `.metadata.labels` on the Deployment**
  This ensures KUTTL can find the resource using a consistent `metadata.name` and label.

- ✅ **Set matching `.spec.selector.matchLabels` manually**
  CDK8s auto-generates a hash-based selector unless you override it.

- ✅ **Patch labels and selectors explicitly via escape hatches**
  ```ts
  ApiObject.of(dep).addJsonPatch(
    JsonPatch.add("/spec/selector/matchLabels/app", "demo-test"),
    JsonPatch.add("/spec/template/metadata/labels/app", "demo-test"),
  );
